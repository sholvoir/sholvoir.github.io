import{A as e,I as t,Q as n,T as r,U as i,V as a,X as o,Y as s,a9 as c,ab as l,ac as u,ad as d,ae as f,b as p,c as m,d as h,e as g,g as _,m as v,y}from"./input-text-7J7HtFvx.js";var b=({card:e,class:t,onClick:n})=>{let r=c(e.phonetic),i=c(JSON.stringify(e.meanings,void 0,4)),a=c(e.sound),o=c(!1),s=u(null),l=()=>{a.value?s.current?.play():v(`no sound to play!`)},d=t=>{try{e.meanings=JSON.parse(i.value=t.currentTarget.value),o.value=!1}catch{o.value=!0}};return _(`div`,{class:`flex flex-col h-full gap-2 ${t??``}`,onClick:n,children:[_(`input`,{name:`phonetic`,placeholder:`phonetic`,value:r,onFocus:n,onInput:t=>e.phonetic=r.value=t.currentTarget.value}),_(`textarea`,{name:`meanings`,placeholder:`meanings`,class:`h-32 grow ${o.value?`text-red`:``}`,value:i,onInput:d,onFocus:n}),_(`div`,{class:`shrink flex`,children:[_(`textarea`,{name:`sound`,rows:1,placeholder:`sound`,class:`grow`,value:a,onInput:t=>e.sound=a.value=t.currentTarget.value,onFocus:n}),_(g,{class:`button btn-normal`,onClick:()=>e.sound=a.value=`https://dict.youdao.com/dictvoice?type=2&audio=`,children:_(`span`,{class:`text-[150%] i-material-symbols-chevron-right`})}),_(g,{class:`button btn-normal`,onClick:l,disabled:!a.value,children:_(`span`,{class:`text-[150%] i-material-symbols-chevron-right`})})]}),_(`audio`,{ref:s,src:a})]})};function x(){let u=c(!1),d=c([]),v=c(``),x=()=>v.value=``,S=(e,t=!0)=>(v.value=e,t&&setTimeout(x,3e3)),C=c(``),w=async()=>{let e=await y(C.value);S(e?`上传成功`:`上传失败`)},T=c(``),E=c(`_`),D=c(0),O=c([]),k=async()=>{let t=encodeURIComponent(T.value);window.open(`https://www.merriam-webster.com/dictionary/${t}`,`merriam-webster`),window.open(`https://www.oxfordlearnersdictionaries.com/us/search/english/?q=${t}`,`oxfordlearnersdictionaries`);let n=await e(T.value);if(!n)return S(`Not Found`);if(E.value=n.word,D.value=0,n.cards){for(let e of n.cards)if(e.meanings){for(let t of e.meanings)if(t.meaning)for(let e of t.meaning)e.trans||=``}}O.value=n.cards??[],window.focus()},A=async()=>{let e=await a(T.value);if(e){if(e.meanings){for(let t of e.meanings)if(t.meaning)for(let e of t.meaning)e.trans=``}O.value=[...O.value,e]}},j=()=>{O.value.length>1&&(O.value=O.value.toSpliced(D.value,1)),D.value>=O.value.length&&(D.value=O.value.length-1)},M=async()=>{let e={word:T.value,cards:O.value};S(await t(e)?`success update word "${T.value}"!`:`Error`)},N=async()=>{S(await o(T.value)?`success delete word "${T.value}"!`:`Error`)},P=c(0),F=c([]),I=async()=>{let e=await i();e&&(F.value=e,L())},L=()=>{let e=F.value[P.value];e&&(T.value=e.issue,k())},R=async()=>{let e=F.value[P.value],t=await s(e._id);t.acknowledged&&t.deletedCount>0?(F.value=[...F.value.slice(0,P.value),...F.value.slice(P.value+1)],P.value>=F.value.length&&(P.value=F.value.length-1),F.value.length?L():(T.value=``,E.value=`_`,O.value=[],D.value=0,I()),S(`处理成功!`)):S(`处理失败`)},z=async()=>{(u.value=await n()===`hua`)&&(d.value=await r()??[],await I())};return l(()=>{z()},[]),u.value&&_(f,{children:[_(`div`,{class:`text-center bg-[var(--bg-title)] p-1`,children:v.value||`系统管理-${D.value}-${h} ˈʒɑɜæəɪʌʊʃˌ`}),_(`div`,{class:`body grow flex flex-col gap-2 p-2`,children:[_(`div`,{class:`h-4 grow-4 flex flex-col gap-2`,children:[_(`div`,{class:`flex gap-2`,children:[_(p,{name:`word`,placeholder:`word`,class:`grow`,binding:T,options:d.value,onChange:k}),_(g,{class:`button btn-normal`,disabled:!T.value,onClick:k,children:`Search`})]}),_(`div`,{class:`grow flex gap-2`,children:O.value.map((e,t)=>_(b,{class:`grow`,card:e,onClick:()=>D.value=t},e))}),_(`div`,{class:`flex justify-between gap-2`,children:[_(g,{class:`grow button btn-normal`,disabled:T.value!=E.value,onClick:A,children:`增卡`}),_(g,{class:`grow button btn-normal`,disabled:T.value!=E.value||O.value.length<=1,onClick:j,children:`删卡`}),_(g,{class:`grow button btn-normal`,disabled:T.value!=E.value,onClick:N,children:`删除`}),_(g,{class:`grow button btn-normal`,disabled:T.value!=E.value,onClick:M,children:`更新`})]})]}),_(`div`,{class:`h-1 grow flex gap-2`,children:[_(`div`,{class:`w-1 grow flex flex-col gap-2`,children:[_(`textarea`,{class:`grow`,value:C,onChange:e=>C.value=e.currentTarget.value}),_(`div`,{class:`flex justify-end`,children:_(g,{class:`w-24 button btn-normal`,onClick:w,children:`拼写忽略`})})]}),_(`div`,{class:`w-1 grow flex flex-col gap-2`,children:[_(`div`,{class:`grow border`,children:_(m,{class:`px-2`,cindex:P,activeClass:`bg-[var(--bg-title)]`,options:F.value.map(e=>`${e.reporter}: ${e.issue}`),onClick:L})}),_(`div`,{class:`flex justify-end gap-2`,children:[_(g,{class:`w-24 button btn-normal`,onClick:I,children:`加载问题`}),_(g,{class:`w-24 button btn-normal`,onClick:R,children:`处理问题`})]})]})]})]})]})}d(_(x,{}),document.getElementById(`root`));