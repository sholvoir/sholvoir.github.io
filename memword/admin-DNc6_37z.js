import{A as e,E as t,button_ripple_default as n,deleteDict as r,deleteServerIssue as i,getDict as a,getServerIssues as o,getUser as s,getVocabulary as c,input_text_default as l,k as u,list_default as d,postVocabulary as f,putDict as p,showTips as m,tab_default as h,u as g,useSignal as _,version as v,y}from"./tab-D0cJyNYM.js";var b=({card:t,class:r})=>{let i=_(t.phonetic),a=_(t.trans),o=_(t.def),s=_(t.sound),c=e(null),l=()=>{s.value?c.current?.play():m(`no sound to play!`)};return g(`div`,{class:`flex flex-col h-full gap-2 ${r??``}`,children:[g(`input`,{name:`phonetic`,placeholder:`phonetic`,value:i,onInput:e=>t.phonetic=i.value=e.currentTarget.value}),g(`textarea`,{name:`trans`,placeholder:`trans`,class:`h-32 grow`,value:a,onInput:e=>t.trans=a.value=e.currentTarget.value}),g(`textarea`,{name:`def`,placeholder:`def`,class:`h-32 grow`,value:o,onInput:e=>t.def=o.value=e.currentTarget.value}),g(`div`,{class:`flex`,children:[g(`textarea`,{name:`sound`,placeholder:`sound`,class:`h-32 grow`,value:s,onInput:e=>t.sound=s.value=e.currentTarget.value}),g(n,{class:`button ml-2`,onClick:l,disabled:!s.value,children:g(`span`,{class:`text-[150%] i-material-symbols-chevron-right`})})]}),g(`audio`,{ref:c,src:s})]})};function x(){let e=_(!1),t=_([]),m=_(``),x=()=>m.value=``,S=(e,t=!0)=>(m.value=e,t&&setTimeout(x,3e3)),C=_(``),w=async()=>{let e=await f(C.value);S(e?`上传成功`:`上传失败`)},T=_(``),E=_(`_`),D=_(0),O=_([]),k=async()=>{let e=encodeURIComponent(T.value);window.open(`https://www.merriam-webster.com/dictionary/${e}`,`merriam-webster`),window.open(`https://www.oxfordlearnersdictionaries.com/us/definition/english/${e}`,`oxfordlearnersdictionaries`);let t=await a(T.value);if(!t)return S(`Not Found`);E.value=t.word,D.value=0,O.value=t?.cards??[]},A=()=>{O.value=[...O.value,{}]},j=()=>{O.value.length>1&&(O.value=O.value.toSpliced(D.value,1))},M=async()=>{let e={word:T.value,cards:O.value};S(await p(e)?`success update word "${T.value}"!`:`Error`)},N=async()=>{S(await r(T.value)?`success delete word "${T.value}"!`:`Error`)},P=_(0),F=_([]),I=async()=>{let e=await o();e&&(F.value=e,L())},L=()=>{let e=F.value[P.value];e&&(T.value=e.issue,k())},R=async()=>{let e=F.value[P.value],t=await i(e._id);t.acknowledged&&t.deletedCount>0?(F.value=[...F.value.slice(0,P.value),...F.value.slice(P.value+1)],P.value>=F.value.length&&(P.value=F.value.length-1),F.value.length?L():(T.value=``,E.value=`_`,O.value=[],D.value=0,I()),S(`处理成功!`)):S(`处理失败`)},z=async()=>{(e.value=await s()===`hua`)&&(t.value=await c()??[],await I())};return y(()=>{z()},[]),e.value&&g(u,{children:[g(`div`,{class:`text-center bg-[var(--bg-title)] p-1`,children:m.value||`系统管理-${v} ˈʒɑɜæəɪʌʊʃˌ`}),g(`div`,{class:`body grow flex flex-col gap-2 p-2`,children:[g(`div`,{class:`h-4 grow-4 flex flex-col gap-2`,children:[g(`div`,{class:`flex gap-2`,children:[g(l,{name:`word`,placeholder:`word`,class:`grow`,binding:T,options:t.value,onChange:k}),g(n,{class:`button btn-normal`,disabled:!T.value,onClick:k,children:`Search`})]}),g(`div`,{class:`flex flex-col grow`,children:g(h,{class:`bg-[var(--bg-tab)]`,cindex:D,children:O.value.map(e=>g(b,{card:e},e))})}),g(`div`,{class:`flex justify-between gap-2`,children:[g(n,{class:`grow button btn-normal`,disabled:T.value!=E.value,onClick:A,children:`增卡`}),g(n,{class:`grow button btn-normal`,disabled:T.value!=E.value||O.value.length<=1,onClick:j,children:`删卡`}),g(n,{class:`grow button btn-normal`,disabled:T.value!=E.value,onClick:N,children:`删除`}),g(n,{class:`grow button btn-normal`,disabled:T.value!=E.value,onClick:M,children:`更新`})]})]}),g(`div`,{class:`h-1 grow flex gap-2`,children:[g(`div`,{class:`w-1 grow flex flex-col gap-2`,children:[g(`textarea`,{class:`grow`,value:C,onChange:e=>C.value=e.currentTarget.value}),g(`div`,{class:`flex justify-end`,children:g(n,{class:`w-24 button btn-normal`,onClick:w,children:`拼写忽略`})})]}),g(`div`,{class:`w-1 grow flex flex-col gap-2`,children:[g(`div`,{class:`grow border`,children:g(d,{class:`px-2`,cindex:P,activeClass:`bg-[var(--bg-title)]`,options:F.value.map(e=>`${e.reporter}: ${e.issue}`),onClick:L})}),g(`div`,{class:`flex justify-end gap-2`,children:[g(n,{class:`w-24 button btn-normal`,onClick:I,children:`加载问题`}),g(n,{class:`w-24 button btn-normal`,onClick:R,children:`处理问题`})]})]})]})]})]})}t(g(x,{}),document.getElementById(`root`));