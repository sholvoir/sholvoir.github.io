import{B as e,J as t,R as n,U as r,V as i,W as a,Y as o,Z as s,aa as c,ac as l,ad as u,ae as d,af as f,b as p,c as m,d as h,e as g,f as _,h as v,n as y,z as b}from"./input-text-D9GZe-de.js";var x=({card:e,class:t,onClick:n})=>{let r=c(e.phonetic),i=c(JSON.stringify(e.meanings,void 0,4)),a=c(e.sound),o=c(!1),s=u(null),l=()=>{a.value?s.current?.play():y(`no sound to play!`)},d=t=>{try{e.meanings=JSON.parse(i.value=t.currentTarget.value),o.value=!1}catch{o.value=!0}};return v(`div`,{class:`flex flex-col h-full gap-2 ${t??``}`,onClick:n,children:[v(`input`,{name:`phonetic`,placeholder:`phonetic`,value:r,onFocus:n,onInput:t=>e.phonetic=r.value=t.currentTarget.value}),v(`textarea`,{name:`meanings`,placeholder:`meanings`,class:`h-32 grow ${o.value?`text-red`:``}`,value:i,onInput:d,onFocus:n}),v(`div`,{class:`shrink flex`,children:[v(`textarea`,{name:`sound`,rows:1,placeholder:`sound`,class:`grow`,value:a,onInput:t=>e.sound=a.value=t.currentTarget.value,onFocus:n}),v(_,{class:`button ml-2`,onClick:l,disabled:!a.value,children:v(`span`,{class:`text-[150%] i-material-symbols-chevron-right`})})]}),v(`audio`,{ref:s,src:a})]})};function S(){let u=c(!1),d=c([]),y=c(``),S=()=>y.value=``,C=(e,t=!0)=>(y.value=e,t&&setTimeout(S,3e3)),w=c(``),T=async()=>{let e=await b(w.value);C(e?`上传成功`:`上传失败`)},E=c(``),D=c(`_`),O=c(0),k=c([]),A=c(``),j=async()=>{let t=encodeURIComponent(E.value);window.open(`https://www.oxfordlearnersdictionaries.com/us/search/english/?q=${t}`,`oxfordlearnersdictionaries`),window.open(`https://www.merriam-webster.com/dictionary/${t}`,`merriam-webster`);let n=await e(E.value);if(!n)return C(`Not Found`);D.value=n.word,O.value=0,k.value=n?.cards??[],A.value=n.word},M=async()=>{let e=await a(A.value);if(e){if(e.meanings){for(let t of e.meanings)if(t.meaning)for(let e of t.meaning)e.trans=``}k.value=[...k.value,e]}},N=()=>{k.value.length>1&&(k.value=k.value.toSpliced(O.value,1))},P=async()=>{let e={word:E.value,cards:k.value};C(await t(e)?`success update word "${E.value}"!`:`Error`)},F=async()=>{C(await o(E.value)?`success delete word "${E.value}"!`:`Error`)},I=c(0),L=c([]),R=async()=>{let e=await i();e&&(L.value=e,z())},z=()=>{let e=L.value[I.value];e&&(E.value=e.issue,j())},B=async()=>{let e=L.value[I.value],t=await s(e._id);t.acknowledged&&t.deletedCount>0?(L.value=[...L.value.slice(0,I.value),...L.value.slice(I.value+1)],I.value>=L.value.length&&(I.value=L.value.length-1),L.value.length?z():(E.value=``,D.value=`_`,k.value=[],O.value=0,R()),C(`处理成功!`)):C(`处理失败`)},V=async()=>{(u.value=await n()===`hua`)&&(d.value=await r()??[],await R())};return l(()=>{V()},[]),u.value&&v(f,{children:[v(`div`,{class:`text-center bg-[var(--bg-title)] p-1`,children:y.value||`系统管理-${O.value}-${h} ˈʒɑɜæəɪʌʊʃˌ`}),v(`div`,{class:`body grow flex flex-col gap-2 p-2`,children:[v(`div`,{class:`h-4 grow-4 flex flex-col gap-2`,children:[v(`div`,{class:`flex gap-2`,children:[v(p,{name:`word`,placeholder:`word`,class:`grow`,binding:E,options:d.value,onChange:j}),v(_,{class:`button btn-normal`,disabled:!E.value,onClick:j,children:`Search`})]}),v(`div`,{class:`grow flex gap-2`,children:k.value.map((e,t)=>v(x,{class:`grow`,card:e,onClick:()=>O.value=t},e))}),v(`div`,{class:`flex justify-between gap-2`,children:[v(g,{class:`grow`,binding:A}),v(_,{class:`grow button btn-normal`,disabled:E.value!=D.value,onClick:M,children:`增卡`}),v(_,{class:`grow button btn-normal`,disabled:E.value!=D.value||k.value.length<=1,onClick:N,children:`删卡`}),v(_,{class:`grow button btn-normal`,disabled:E.value!=D.value,onClick:F,children:`删除`}),v(_,{class:`grow button btn-normal`,disabled:E.value!=D.value,onClick:P,children:`更新`})]})]}),v(`div`,{class:`h-1 grow flex gap-2`,children:[v(`div`,{class:`w-1 grow flex flex-col gap-2`,children:[v(`textarea`,{class:`grow`,value:w,onChange:e=>w.value=e.currentTarget.value}),v(`div`,{class:`flex justify-end`,children:v(_,{class:`w-24 button btn-normal`,onClick:T,children:`拼写忽略`})})]}),v(`div`,{class:`w-1 grow flex flex-col gap-2`,children:[v(`div`,{class:`grow border`,children:v(m,{class:`px-2`,cindex:I,activeClass:`bg-[var(--bg-title)]`,options:L.value.map(e=>`${e.reporter}: ${e.issue}`),onClick:z})}),v(`div`,{class:`flex justify-end gap-2`,children:[v(_,{class:`w-24 button btn-normal`,onClick:R,children:`加载问题`}),v(_,{class:`w-24 button btn-normal`,onClick:B,children:`处理问题`})]})]})]})]})]})}d(v(S,{}),document.getElementById(`root`));