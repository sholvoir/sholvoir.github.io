import{A as e,E as t,button_ripple_default as n,deleteDict as r,deleteServerIssue as i,getDict as a,getServerIssues as o,getUser as s,input_text_default as c,list_default as l,postVocabulary as u,putDict as d,showTips as f,tab_default as p,u as m,useSignal as h,vocabulary as g,y as _}from"./tab-CUpbGeds.js";var v=({card:t,class:r})=>{let i=h(t.phonetic),a=h(t.trans),o=h(t.def),s=h(t.sound),c=e(null),l=()=>{s.value?c.current?.play():f(`no sound to play!`)};return m(`div`,{class:`flex flex-col h-full gap-2 ${r??``}`,children:[m(`input`,{name:`phonetic`,placeholder:`phonetic`,value:i,onInput:e=>t.phonetic=i.value=e.currentTarget.value}),m(`textarea`,{name:`trans`,placeholder:`trans`,class:`h-32 grow`,value:a,onInput:e=>t.trans=a.value=e.currentTarget.value}),m(`textarea`,{name:`def`,placeholder:`def`,class:`h-32 grow`,value:o,onInput:e=>t.def=o.value=e.currentTarget.value}),m(`div`,{class:`flex`,children:[m(`textarea`,{name:`sound`,placeholder:`sound`,class:`h-32 grow`,value:s,onInput:e=>t.sound=s.value=e.currentTarget.value}),m(n,{class:`button ml-2`,onClick:l,disabled:!s.value,children:m(`span`,{class:`text-[150%] i-material-symbols-chevron-right`})})]}),m(`audio`,{ref:c,src:s})]})};function y(){let e=h(``),t=h(0),y=h([]),b=h(``),x=h(0),S=h([]),C=async()=>{let t=await u(e.value);f(t?`上传成功`:`上传失败`)},w=()=>{let e=y.value[t.value];b.value=e.issue,E()},T=async()=>{let e=y.value[t.value],n=await i(e._id);n.acknowledged&&n.deletedCount>0?(y.value=[...y.value.slice(0,t.value),...y.value.slice(t.value+1)],f(`处理成功!`)):f(`处理失败`)},E=async()=>{let e=await a(b.value);if(!e)return f(`Not Found`);x.value=0,S.value=e?.cards??[]},D=()=>{S.value=[...S.value,{}]},O=()=>{S.value.length>1&&(S.value=S.value.toSpliced(x.value,1))},k=async()=>{let e={word:b.value,cards:S.value};f(await d(e)?`success update word "${b.value}"!`:`Error`)},A=async()=>{f(await r(b.value)?`success delete word "${b.value}"!`:`Error`)};return _(()=>{s().then(()=>o()).then(e=>e&&(y.value=e))},[]),m(`div`,{class:`body grow flex flex-col gap-2 p-2 text-lg`,children:[m(`fieldset`,{class:`h-1 grow border rounded p-2 flex flex-col gap-2`,children:[m(`legend`,{children:`拼写忽略`}),m(`textarea`,{class:`grow`,value:e,onChange:t=>e.value=t.currentTarget.value}),m(`div`,{class:`flex justify-end`,children:m(n,{class:`w-24 button btn-normal`,onClick:C,children:`上传`})})]}),m(`fieldset`,{class:`h-1 grow border rounded p-2 flex flex-col gap-2`,children:[m(`legend`,{children:`处理问题`}),m(`div`,{class:`grow border`,children:m(l,{class:`px-2`,cindex:t,activeClass:`bg-[var(--bg-title)]`,options:y.value.map(e=>`${e.reporter}: ${e.issue}`),onClick:w})}),m(`div`,{class:`flex justify-end`,children:m(n,{class:`w-24 button btn-normal`,onClick:T,children:`处理`})})]}),m(`fieldset`,{class:`h-3 grow-3 border rounded p-2 flex flex-col gap-2`,children:[m(`legend`,{children:`辞典编辑`}),m(`div`,{class:`flex gap-2`,children:[m(c,{name:`word`,placeholder:`word`,class:`grow`,binding:b,options:g,onChange:E}),m(n,{class:`button btn-normal`,disabled:!b.value,onClick:E,children:`Search`})]}),m(`div`,{class:`flex flex-col grow`,children:m(p,{class:`bg-[var(--bg-tab)]`,cindex:x,children:S.value.map(e=>m(v,{card:e},e))})}),m(`div`,{class:`flex justify-between gap-2`,children:[m(n,{class:`grow button btn-normal`,disabled:!b.value,onClick:D,children:`增卡`}),m(n,{class:`grow button btn-normal`,disabled:!b.value||S.value.length<=1,onClick:O,children:`删卡`}),m(n,{class:`grow button btn-normal`,disabled:!b.value,onClick:A,children:`删除`}),m(n,{class:`grow button btn-normal`,disabled:!b.value,onClick:k,children:`更新`})]})]})]})}t(m(y,{}),document.getElementById(`root`));