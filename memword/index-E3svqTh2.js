import{$ as e,A as t,B as n,C as r,D as i,E as a,F as o,G as s,H as c,I as l,J as u,K as d,L as f,M as p,N as m,T as h,W as g,X as _,Y as v,Z as y,_ as b,a1 as x,a2 as S,a3 as ee,a4 as C,a5 as w,a6 as T,a7 as E,a8 as D,a9 as O,aa as te,ab as k,ac as A,ad as j,b as M,c as N,d as P,e as F,f as I,g as ne,h as L,i as R,j as z,k as re,l as B,m as ie,n as V,o as H,p as U,q as W,r as G,s as ae,t as oe,u as K,v as q,w as J,x as se,y as ce,z as le}from"./input-text-mlonA-4l.js";var ue=e=>I(`svg`,{xmlns:`http://www.w3.org/2000/svg`,viewBox:`0 0 128 128`,...e,children:I(`g`,{children:[I(`circle`,{cx:`16`,cy:`64`,r:`16`,fill:`#000000`}),I(`circle`,{cx:`16`,cy:`64`,r:`16`,fill:`#555555`,transform:`rotate(45,64,64)`}),I(`circle`,{cx:`16`,cy:`64`,r:`16`,fill:`#949494`,transform:`rotate(90,64,64)`}),I(`circle`,{cx:`16`,cy:`64`,r:`16`,fill:`#cccccc`,transform:`rotate(135,64,64)`}),I(`circle`,{cx:`16`,cy:`64`,r:`16`,fill:`#e1e1e1`,transform:`rotate(180,64,64)`}),I(`circle`,{cx:`16`,cy:`64`,r:`16`,fill:`#e1e1e1`,transform:`rotate(225,64,64)`}),I(`circle`,{cx:`16`,cy:`64`,r:`16`,fill:`#e1e1e1`,transform:`rotate(270,64,64)`}),I(`circle`,{cx:`16`,cy:`64`,r:`16`,fill:`#e1e1e1`,transform:`rotate(315,64,64)`}),I(`animateTransform`,{attributeName:`transform`,type:`rotate`,values:`45 64 64;90 64 64;135 64 64;180 64 64;225 64 64;270 64 64;315 64 64;0 64 64;`,calcMode:`discrete`,dur:`720ms`,repeatCount:`indefinite`})]})}),Y=({title:e,children:t,leftElem:n,rightElem:r,class:i,onBackClick:a,...o})=>I(j,{children:[I(`div`,{class:`title shrink-0 px-2 flex justify-between items-center font-bold`,children:[I(`div`,{class:`w-7 [app-region:no-drag]`,children:n??(a&&I(F,{onClick:a,class:`w-full h-7 i-material-symbols-chevron-left`}))}),I(`div`,{class:`grow font-bold text-center [app-region:drag]`,children:oe.value||e}),I(`div`,{class:`w-7 [app-region:no-drag]`,children:r??!1})]}),I(`div`,{class:`body relative grow h-0 ${i??``}`,...o,children:[t,H.value&&I(`div`,{class:`absolute inset-0 bg-[var(--bg-half)] flex justify-center content-center flex-wrap`,children:I(ue,{class:`w-16 h-16`})})]})]});const X=(e,t)=>e+t,de=(e,t)=>e>t?e:t;var fe=({stat:e})=>{let t=E(e.total),n=E(e.task),r=t.reduce(de)*1.2,i=e.total.reduce(X),a=e.task.reduce(X),o=e.wlid?S(e.wlid)[1]:``,s=`${e.disc??o} - ${a}|${i}`,c=e=>{let i=t[e],a=n[e];return I(j,{children:[I(`div`,{class:`text-left`,children:T[e]}),I(`div`,{class:`relative bg-[var(--bg-title)] h-6 py-1 w-full hover:cursor-pointer`,children:[I(`div`,{class:`my-auto h-4 bg-slate-400`,style:{width:`${r?i*100/r:100}%`},children:I(`div`,{class:`ml-auto h-full bg-orange-500`,style:{width:`${i?a*100/i:0}%`}})}),I(`div`,{class:`absolute top-0 right-1`,children:[a,`|`,i]})]})]})};return I(`div`,{class:`grow min-w-80 grid gap-x-1 grid-cols-[max-content_1fr] items-center`,children:[I(`div`,{class:`col-span-2 text-center font-bold`,children:I(`button`,{type:`button`,class:`hover:cursor-pointer hover:underline`,onClick:()=>G(e.wlid),children:s})}),[0,1,2,3,4,5].map(c)]})},pe=()=>I(Y,{class:`flex flex-col`,title:`学习进度`,children:[I(`div`,{class:`body grow overflow-y-auto`,children:I(`div`,{class:`p-2 flex flex-wrap justify-between gap-4`,children:ae.value.stats.map(e=>I(fe,{stat:e},`${e.time}${e.wlid}`))})}),I(`div`,{class:`tail shrink-0 px-4 pt-2 pb-5 flex gap-3 justify-between [&>button]:grow [&>button>i]:align-[-30%] [&>button]:min-w-[110px] [&>button>i]:text-4xl font-bold overflow-x-auto [scrollbar-width:none]`,children:[I(P,{onClick:()=>z(`#search`),children:[I(`i`,{class:`i-material-symbols-dictionary-outline`}),` 词典`]}),I(P,{onClick:()=>G(),children:[I(`i`,{class:`i-hugeicons-online-learning-01`}),` 学习`]}),I(P,{onClick:()=>z(`#setting`),children:[I(`i`,{class:`i-material-symbols-settings`}),` 设置`]}),I(P,{onClick:()=>z(`#about`),children:[I(`i`,{class:`i-tabler-info-octagon-filled`}),` 关于`]}),I(P,{onClick:()=>z(`#issue`),children:[I(`i`,{class:`i-material-symbols-error`}),` 问题`]}),I(P,{onClick:()=>z(`#help`),children:[I(`i`,{class:`i-material-symbols-help-outline`}),` 帮助`]})]})]}),me=()=>I(Y,{class:`flex flex-col pb-4`,title:`帮助`,onBackClick:()=>z(),children:I(`ol`,{class:`list-decimal py-2 pr-2 pl-8 [&>li]:mx-2 overflow-y-auto`,children:[I(`li`,{children:[`如何使用本软件？`,I(`br`,{}),`答：点击「学习」，开始学习即可；在学习界面， (1)当练习听力时，会先播放一小段声音，没有听清可以点击`,I(`div`,{class:`w-6 h-6 inline-block`,children:`‣`}),`或按下「B或C」快捷键或触摸屏幕的上半部分进行重听， (2)当练习阅读时，会先显示一个单词； 然后在心里默想一个概念（意思），点击「答」或按下「空格键」或触摸屏幕下半区域，显示单词的音标和解释， 并同时显示一个与该词相关的背景图片，检查是否和自己默想的答案一致，如果一致，点击「知」或按下「N或X」快捷键或向上滑动屏幕， 否则点击「不」或按下「M或Z」快捷键或向下滑动屏幕。记住，要快速完成，不要在一个词上长时间停留，那样只会降低效率， 我们的方法是快速/多次，从记忆效率来讲，次数的作用远远大于时长。这个方法称为大脑按摩，直接在拼写/声音和概念之间建立反射弧， 所以不要犹豫，快速完成一个小冲刺。`]}),I(`li`,{children:[`我应该学习哪些词汇？`,I(`br`,{}),`答：我们的目标是在未来能够自由使用英语，应该先学重要的词汇，因为20%的英语词汇表达了80%的意思， 抓住少数基本词，将能够快速提高英语水平。本软件提供多本词书供您选择，以适应您当下的需求。但不要太多关注词书， 一个常用词通常会出现在多本词书中，不必介意它到底从哪里来。也可以不选择词书，直接基于词典 （本词典收录25000多条常用词，不在词典中的词，对于学生而言，可以不必记忆了），在词典中查到自己在生活中遇到， 但不会的词，直接开始学它，背它，终有一日，你再也遇不到生词的时候，你就已经功法大成了。`]}),I(`li`,{children:[`我该如何复习？`,I(`br`,{}),`答：完全不必操心这个事情，让系统决定，系统自动根据「艾宾浩斯」遗忘曲线来决定此时的最佳复习内容， 你要做的事是每天利用碎片时间，拿出手机，开始「学习」。`]}),I(`li`,{children:[`界面上的按钮是什么意思？`,I(`br`,{}),I(`span`,{class:`text-[150%] i-material-symbols-check-circle text-green`}),`我认识这个词；`,I(`br`,{}),I(`span`,{class:`text-[150%] i-gridicons-cross-circle text-fuchsia`}),`我不认识这个词；`,I(`br`,{}),I(`span`,{class:`text-[150%] i-material-symbols-volume-up text-blue`}),`: 再播一遍声音；`,I(`br`,{}),I(`span`,{class:`text-[150%] i-material-symbols-light-family-star text-yellow`}),`: 这个词我已经掌握，直接标记为「已完成」；`,I(`br`,{}),I(`span`,{class:`text-[150%] i-material-symbols-error text-red`}),`: 这个词的翻译/声音/音标，有问题/错误，请人工处理。`,I(`br`,{}),I(`span`,{class:`text-[150%] i-material-symbols-refresh text-purple`}),`: 忽略本地词典缓冲，从服务器重新下载这个词的翻译/声音/音标。`]}),I(`li`,{children:[`关于「学习词书」`,I(`br`,{}),`答：学习词书将一本词书的全部词添加进我的学习任务。但我们通常并不会直接开始学这些新词，而是优先复习旧词， 掌握巩固一个旧词比学习一批新词更重要，这些新加的任务将会成为优先级最低的任务。`]}),I(`li`,{children:[`关于登录和多设备`,I(`br`,{}),`答：⓵软件设计为免密模式（不需要密码），在一个设备上只要用电子邮件验证身份之后，就再也不需要密码了，打开软件立即可以开始学习。`,I(`br`,{}),`⓶在第二台设备上登录时，系统将自动同步学习记录和设置，你完全可以同时在电脑和手机上学习。`]}),I(`li`,{children:[`以后有AI翻译了，我还用得着学英语吗？`,I(`br`,{}),`答：AI或者任意翻译工具甚至包括人工翻译，都只能解决浅表问题，因为一门语言是无法准确表达另一门语言的含义的， 一门语言的背后代表着文化和思维模式，这些深层次的东西是任何翻译都无法解决的。如果你有计划去英语文华圈生活/学习/工作， 那你必需亲自用人脑学好它，仅仅翻译工具是不够的。`]})]})}),Z=({binding:e,...t})=>I(`input`,{...t,value:e.value?.toString(),onInput:t=>e.value=t.currentTarget.value}),he=()=>{let e=D(!1),t=D(``);return I(Y,{title:`快乐背单词`,class:`about flex flex-col pb-4 font-extrabold overflow-y-auto`,onBackClick:q.value?()=>z(`#home`):void 0,children:[e.value&&I(j,{children:[I(Z,{binding:t}),I(F,{class:`button btn-normal`,onClick:()=>y(`_auth`,t.value),children:`OK`})]}),I(`div`,{children:[I(`h1`,{children:`快乐背单词`}),I(`p`,{children:[`版本：`,C]})]}),I(`div`,{children:[I(`h1`,{children:`语言基础`}),I(`p`,{children:[`词汇是`,I(`b`,{children:`语言的基础`}),`，学习语言应该掌握一定数量的基础词汇。`]})]}),I(`div`,{children:[I(`h1`,{children:`高频词汇`}),I(`p`,{children:[`每个词汇的重要程度是不一样的，越是使用`,I(`b`,{children:`频率高的词汇`}),`，其重要程度越高，本工具提供多种词频工具统计的结果词书。`]})]}),I(`div`,{children:[I(`h1`,{children:`遗忘曲线`}),I(`p`,{children:[`记忆最大的敌人是遗忘，本工具依据「艾宾浩斯」`,I(`b`,{children:`遗忘曲线`}),`设计大脑刺激频率，以最大化记忆效率。`]})]}),I(`div`,{children:[I(`h1`,{children:`碎片时间`}),I(`p`,{children:[`现代人工作学习都非常忙碌，充分利用好`,I(`b`,{children:`碎片时间`}),`，是成功的关键。`]})]}),I(`div`,{children:[I(`h1`,{children:`开始学习`}),I(`p`,{children:[`使用你的手机，单击`,I(P,{class:`button bg-orange-300 text-slate-800`,title:`login`,onClick:()=>z(`#signup`),children:`登录`}),`开始免费学习吧。`]})]}),I(`div`,{children:[I(`h1`,{children:`微信`}),I(`p`,{children:[`*提示一：请使用`,I(`b`,{children:`除微信以外`}),`的其他浏览器，如果当前是在微信中，点击屏幕右上(...)，然后选择「在默认浏览器中打开」。`]})]}),I(`div`,{children:[I(`h1`,{children:`桌面`}),I(`p`,{children:[`*提示二(iOS): 请使用「共享」-「添加到主屏幕」安装 `,I(`b`,{children:`Web应用`}),` 到桌面，以便下次直接`,I(F,{onClick:()=>e.value=!0,children:`点击`}),`进入。`]}),I(`p`,{children:[`*提示三(Android): 请使用「...」-「安装应用」安装 `,I(`b`,{children:`Web应用`}),` 到桌面，以便下次直接点击进入。`]})]})]})},Q=({binding:e,...t})=>I(`textarea`,{...t,value:e.value,onInput:t=>e.value=t.currentTarget.value}),ge=()=>{let e=D(``),t=async()=>{await u(e.value),U(`提交成功!`),z()};return I(Y,{class:`p-2 flex flex-col`,title:`提交问题`,children:[I(`label`,{children:`请在这里描述你的问题:`}),I(Q,{name:`issue`,class:`grow`,binding:e,children:e.value}),I(`div`,{class:`flex gap-2 mt-2 pb-3 justify-end`,children:[I(P,{class:`w-24 button btn-normal`,onClick:()=>z(),children:`取消`}),I(P,{class:`w-24 button btn-prime`,onClick:t,children:`提交`})]})]})},_e=()=>{let t=D([]),n=D(0),r=D([]),i=D(0),a=D([]),o=D(0),s=D(`^common`),l=()=>{L.value=void 0,z(`#book`)},u=()=>{L.value=t.value[n.value],z(`#book`)},f=async()=>{let e=await ce(t.value[n.value].bid);U(e?`删除成功`:`删除失败`),e&&(t.value=t.value.filter((e,t)=>t!=n.value))},p=()=>{r.value=[...r.value,a.value[o.value]]},m=()=>{r.value=[...r.value.slice(0,i.value),...r.value.slice(i.value+1)]},h=async()=>{H.value=!0,await se(r.value[i.value].bid),await K(),H.value=!1},g=async()=>{await d({format:ee,version:e(),books:r.value.map(e=>e.bid)}),await K(),z()},y=()=>{q.value=``,z(`#about`),_()},b=async()=>{a.value=(await v(e=>e.bid.startsWith(`common`))).sort(x),r.value=await v(e=>c.books.includes(e.bid)),t.value=await v(e=>e.bid.startsWith(q.value))};return O(()=>{(async()=>{let e=new RegExp(s.value);a.value=(await v(t=>e.test(t.bid)||t.disc&&e.test(t.disc))).sort(x)})()}),k(()=>{b()},[]),I(Y,{class:`p-2 gap-2 flex flex-col`,title:`设置`,children:[I(`fieldset`,{class:`border rounded shrink-0 overflow-y-auto px-2`,children:[I(`legend`,{children:`我的词书`}),I(N,{cindex:n,options:t.value.map(e=>e.disc??e.bid),class:`px-2`,activeClass:`bg-[var(--bg-title)]`})]}),I(`div`,{class:`flex justify-between gap-2`,children:[I(P,{class:`button btn-normal grow`,name:`new`,onClick:l,children:`新建`}),I(P,{class:`button btn-normal grow`,name:`delete`,disabled:!t.value.length,onClick:f,children:`删除`}),I(P,{class:`button btn-normal grow`,name:`update`,disabled:!t.value.length,onClick:u,children:`更新`})]}),I(`div`,{class:`flex gap-2`,children:[I(`label`,{for:`filter`,children:`设置过滤`}),I(Z,{class:`grow`,name:`filter`,binding:s})]}),I(`fieldset`,{class:`border rounded max-h-[70%] grow shrink overflow-y-auto px-2`,children:[I(`legend`,{children:`可用的词书`}),I(N,{class:`px-2`,cindex:o,options:a.value.map(e=>e.disc??e.bid),activeClass:`bg-[var(--bg-title)]`})]}),I(`div`,{class:`flex justify-between gap-2`,children:[I(P,{class:`button btn-normal grow`,onClick:p,children:`添加订阅`}),I(P,{class:`button btn-normal grow`,onClick:m,children:`删除订阅`})]}),I(`fieldset`,{class:`border rounded shrink-0 overflow-y-auto px-2`,children:[I(`legend`,{children:`我订阅的词书`}),I(N,{class:`px-2`,cindex:i,options:r.value.map(e=>e.disc??e.bid),activeClass:`bg-[var(--bg-title)]`})]}),I(`div`,{class:`pb-3 flex justify-between gap-2`,children:[I(P,{class:`button btn-normal grow`,onClick:h,children:`添加任务`}),I(P,{class:`button btn-normal grow`,onClick:()=>z(),children:`取消`}),I(P,{class:`button btn-prime grow`,onClick:g,children:`保存`}),I(P,{class:`button btn-normal grow`,onClick:y,children:`登出`})]})]})},ve=()=>{let e=D(``),t=async()=>{let t=e.peek().trim();if(!t)return;let n=await s(t);if(!n)return U(`Not Found!`);R.value=n,B.value=!0,W.value=-1,z(`#study`)};return I(Y,{class:`flex flex-col text-lg`,title:`词典`,onBackClick:()=>z(),children:I(M,{autoCapitalize:`none`,type:`search`,name:`word`,placeholder:`word`,class:`m-2 w-[calc(100%-16px)]`,binding:e,onChange:t,options:J})})};const ye=e=>new Promise(t=>setTimeout(t,e));var be=({class:e,cindex:t,children:n})=>{let r=Array.isArray(n)?n:[n];return r.length?I(j,{children:[I(`header`,{class:`flex gap-2`,children:r?.map((n,r)=>I(`div`,{class:`min-w-16 px-2 py-1 cursor-pointer text-center rounded-t-md ${t.value==r?e??``:``}`,onClick:e=>(e.stopPropagation(),t.value=r),children:n.props.title??r},r))}),I(`section`,{class:`grow p-2 ${e??``}`,children:r[t.value]})]}):void 0},xe=({entry:e})=>Object.entries(e.meanings).map(([e,t])=>I(j,{children:[e&&I(`p`,{class:`text-xl font-bold text-[var(--accent-color)]`,children:e}),t?.map(e=>I(`p`,{children:[I(`span`,{children:` - `}),e.def&&I(`span`,{class:`text-lg`,children:e.def}),e.def&&e.trans&&I(`span`,{children:` `}),e.trans&&I(`span`,{class:`text-xl font-bold`,children:e.trans})]},e))]},e)),Se=()=>{let e=async()=>{z(W.value<0?`#search`:void 0),await K(),await f(),K()},r=te(null),i=D(0),a={startY:0,endY:0,cScrollTop:0,moveTop:0},o=D([]),s=D(!1),c=te(null),l=async e=>{R.value&&await b(R.value.word,e)},d=async()=>{if(W.value<0)return e();W.value++,R.value=void 0,B.value=!1;let t=await n(ne.value);if(!t)return e();R.value=t,i.value=0},h=async(e,t)=>{let n=Math.abs(a.moveTop+=e);r.current.style.top=`${a.moveTop}px`,n<t&&(await ye(30),await h(e,t))},g=async()=>{U(`Get Server Data...`,!1);let e=await p(R.value);re(),R.value={...e}},_=async()=>{U(`Submiting...`,!1),await u(R.value.word),U(`Submit Success!`)},y=async()=>{U(await le(R.value.word)?`删除成功`:`删除失败`),await d()},x=e=>{if(e.stopPropagation(),!(e.ctrlKey||e.altKey))switch(e.key){case` `:O(e);break;case`N`:case`X`:case`n`:case`x`:B.value&&l().then(d);break;case`M`:case`Z`:case`m`:case`z`:B.value&&l(0).then(d);break}},ee=e=>{e.stopPropagation(),e.preventDefault(),B.value&&(a.endY=a.startY=e.touches[0].clientY,a.cScrollTop=e.currentTarget.scrollTop)},C=e=>{if(e.stopPropagation(),e.preventDefault(),!B.value)return;let t=(a.endY=e.touches[0].clientY)-a.startY,n=e.currentTarget;if(console.log(`diff`,a.endY,a.startY,t),t<0){let e=n.scrollHeight-n.clientHeight;a.cScrollTop-t<e?n.scrollTop=a.cScrollTop-t:(n.scrollTop=e,a.moveTop=e-(a.cScrollTop-t))}else a.cScrollTop-t>0?n.scrollTop=a.cScrollTop-t:(n.scrollTop=0,a.moveTop=t-a.cScrollTop);r.current.style.top=`${a.moveTop}px`,console.log(n.scrollTop,a.moveTop)},T=e=>{e.stopPropagation(),e.preventDefault(),B.value&&(a.moveTop=0,a.cScrollTop=e.currentTarget.scrollTop,r.current.style.top=`${a.moveTop}px`)},E=async e=>{if(e.stopPropagation(),e.preventDefault(),!B.value)return a.moveTop=0,a.cScrollTop=e.currentTarget.scrollTop,r.current.style.top=`${a.moveTop}px`,O();let t=e.currentTarget.scrollHeight+60,n=Math.max(globalThis.innerHeight,t);Math.abs(a.moveTop)>=globalThis.innerHeight/6?(a.moveTop>0?(await l(0),await h(60,n)):(await l(),await h(-60,n)),await d()):Math.abs(a.moveTop)<5&&O(),a.moveTop=0,r.current.style.top=`${a.moveTop}px`},O=e=>{if(e?.stopPropagation(),s.value)return s.value=!1;let t=R.value.entries.length??0;t!==0&&(B.value?t===1?c.current?.play():i.value<t-1?i.value++:i.value=0:(B.value=!0)&&c.current?.play())},A=async e=>{s.value=!1;let n=R.value.word,r=(await t(e.bid))?.content;if(r?.has(n))return U(`已包含`);let[i,a]=S(e.bid),[o]=await m(a,n);U(o==w.OK?`添加成功`:`添加失败`),r?.add(R.value.word)},M=async()=>{o.value=await v(e=>e.bid.startsWith(q.value))};return k(()=>{M()},[]),I(Y,{onBackClick:e,onKeyUp:x,tabIndex:-1,class:`flex flex-col p-2 outline-none`,title:`学习${W.value>0?`(${W.value})`:``}`,children:R.value&&I(j,{children:[I(`div`,{class:`relative flex gap-4 text-[150%] justify-between items-end`,children:[I(F,{disabled:!B.value,title:`X/N`,onClick:()=>l().then(d),class:`i-material-symbols-check-circle text-green`}),I(F,{disabled:!B.value,title:`Z/M`,onClick:()=>l(0).then(d),class:`i-gridicons-cross-circle text-fuchsia`}),I(F,{disabled:!B.value,onClick:()=>l(13).then(d),class:`i-material-symbols-light-family-star text-yellow`}),I(F,{disabled:!B.value,onClick:y,class:`i-material-symbols-delete-outline text-orange`}),I(F,{onClick:()=>c.current?.play(),class:`i-material-symbols-volume-up text-blue`}),I(F,{disabled:!B.value,onClick:_,class:`i-material-symbols-error text-red`}),I(F,{disabled:!B.value,onClick:g,class:`i-material-symbols-refresh text-purple`}),I(F,{disabled:!B.value,onClick:()=>s.value=!s.value,class:`i-material-symbols-dictionary-outline text-cyan`}),I(`div`,{class:`text-lg`,children:R.value.level}),s.value&&I(`div`,{class:`menu absolute top-[100%] right-[36px] text-lg text-right bg-[var(--bg-body)] z-1`,children:[o.value.map(e=>I(j,{children:[I(`div`,{}),I(`menu`,{onClick:()=>A(e),children:e.disc??e.bid})]},e)),o.value.length&&I(`div`,{})]})]}),I(`div`,{class:`relative grow h-0 pb-4 flex flex-col overflow-y-auto`,ref:r,onClick:O,onTouchStart:ee,onTouchMove:C,onTouchEnd:E,onTouchCancel:T,children:[I(`div`,{class:`py-2 flex gap-2 flex-wrap justify-between`,children:[I(`div`,{class:`text-4xl font-bold`,children:R.value.word}),B.value&&I(`div`,{class:`text-2xl flex items-center`,children:R.value.entries?.[i.value].phonetic})]}),B.value&&((R.value.entries.length??0)>1?I(be,{class:`bg-[var(--bg-tab)]`,cindex:i,children:R.value.entries.map((e,t)=>I(xe,{entry:e},`${R.value.word}${t}`))}):I(`div`,{class:`grow`,children:I(xe,{entry:R.value.entries?.[0]})})),I(`audio`,{ref:c,autoPlay:!0,src:R.value.entries.at(i.value)?.sound??``})]})]})})};const Ce=/^[_\w-]+$/,we=/^\+\d+$/;var Te=()=>{let e=D(``),t=()=>{z(`#signin`)},n=async()=>{if(!Ce.test(V.value))return U(`Name can only include _, letter, number and -`);let t=e.value.replaceAll(/[\(\) -]/g,``);if(!we.test(t))return U(`Invalid phone number!`);try{switch((await g(t,V.value)).status){case w.BadRequest:return U(`用户名已注册`);case w.Conflict:return U(`电话号码已注册`);case w.OK:return U(`注册成功，请登录`),z(`#signin`);default:U(`未知数服务器错误`)}}catch{U(`网络错误`)}};return I(Y,{class:`p-2 flex flex-col`,title:`注册`,onBackClick:()=>z(),children:I(`div`,{class:`w-64 m-auto flex flex-col pb-4`,children:[I(`label`,{children:`用户名`}),I(Z,{name:`name`,placeholder:`name`,autoCapitalize:`none`,binding:V,class:`mb-3`}),I(`label`,{children:`手机号码(含国际区号)`}),I(Z,{name:`phone`,placeholder:`+1(987)765-5432`,autoCapitalize:`none`,binding:e,class:`mb-3`}),I(`div`,{class:`text-right mb-3`,children:[`已经注册，请`,I(P,{class:`button btn-normal mx-1`,onClick:t,children:`登录`})]}),I(P,{class:`button btn-prime py-1`,onClick:n,children:`注册`})]})})};let $;var Ee=()=>{let e=D(``),t=D(0),n=D(!0),r=async()=>{n.value=!1,t.value=60,$=setInterval(()=>{--t.value<=0&&(clearInterval($),$=void 0,n.value=!0)},1e3);try{switch((await h(V.value)).status){case w.BadRequest:return U(`请输入用户名`);case w.NotFound:return U(`未找到用户`);case w.FailedDependency:return U(`此用户未注册手机号码`);case w.TooEarly:return U(`请求OTP过于频繁`);case w.OK:return U(`OTP已发送`);default:U(`未知服务器错误`)}}catch{U(`网络错误`)}},i=async()=>{try{switch(await l(V.value,e.value)){case w.BadRequest:return U(`请输入用户名和密码`);case w.NotFound:return U(`未找到用户`);case w.Unauthorized:return U(`错误的密码`);case w.OK:U(`已登录`),$&&clearInterval($),location.reload();break;default:U(`未知服务器错误`)}}catch{U(`网络错误`)}};return I(Y,{class:`p-2 flex flex-col`,title:`登录`,onBackClick:()=>z(),children:I(`div`,{class:`w-64 m-auto flex flex-col`,children:[I(`label`,{for:`name`,children:`用户名`}),I(Z,{name:`name`,class:`mb-3`,placeholder:`name`,autoCapitalize:`none`,binding:V}),I(`label`,{for:`code`,children:`临时密码`}),I(Z,{name:`code`,placeholder:`code`,autoCapitalize:`none`,binding:e}),I(F,{class:`btn-anchor block text-right mb-3`,onClick:r,disabled:!n.value,children:[`Send One-Time Passcode `,t.value>0?`(${t.value})`:``]}),I(P,{class:`button btn-prime`,onClick:i,children:`登录`})]})})},De=({label:e,binding:t,disabled:n,class:r,onChange:i,...a})=>{let o=e=>{e.stopPropagation(),n||(t.value=!t.value,i&&i(e))};return I(`div`,{class:`${n?`opacity-50`:``} ${r??``}`,"aria-disabled":n,onClick:o,...a,children:[I(`span`,{class:`text-[150%] ${t.value?`i-material-symbols-check-box-outline`:`i-material-symbols-check-box-outline-blank`}`}),e]})},Oe=()=>{let e=D(``),n=D(``),r=D(``),i=D(!1),a=D(``),o=async()=>{let n=`${q.value}/${e}`,i=await t(n);i?.content&&(r.value=Array.from(i.content).sort().join(`
`))},s=async()=>{e.value=e.value.replaceAll(`/`,`-`);try{let[t,o]=await m(e.value,r.value,n.value,i.value);switch(t){case w.BadRequest:return U(`Error: 无名称或无内容`);case w.NotAcceptable:return a.value=Object.entries(o).map(([e,t])=>`${e}: ${t.join(`,`)}`).join(`
`),U(`未通过拼写检查`);case w.OK:U(`词书上传成功`),z(`#setting`)}}catch{U(`网络错误`)}};return k(()=>{L.value&&(e.value=S(L.value.bid)[1],L.value.disc&&(n.value=L.value.disc))},[]),I(Y,{class:`flex flex-col p-2`,title:`上传我的词书`,children:[I(`label`,{for:`name`,children:`名称`}),I(Z,{name:`name`,binding:e}),I(`label`,{for:`disc`,class:`mt-2`,children:`描述`}),I(Z,{name:`disc`,binding:n}),I(`label`,{for:`words`,class:`mt-2`,children:`词表`}),I(Q,{name:`words`,class:`grow`,binding:r}),a.value.length?I(j,{children:[I(`label`,{for:`replace`,class:`text-red-500 mt-2`,children:`请考虑用下面的词替换`}),I(`textarea`,{name:`replace`,class:`grow`,value:a,onChange:e=>a.value=e.currentTarget.value})]}):void 0,I(`div`,{class:`flex gap-2 my-2`,children:[I(De,{binding:i,label:`Replace`}),I(`div`,{class:`grow`}),I(P,{class:`w-24 button btn-normal`,onClick:()=>z(`#setting`),children:`取消`}),I(P,{class:`w-24 button btn-normal`,onClick:o,children:`下载`}),I(P,{class:`w-24 button btn-prime`,onClick:s,children:`上传`})]})]})},ke=()=>{let e=new Map;e.set(`#home`,I(pe,{})),e.set(`#help`,I(me,{})),e.set(`#about`,I(he,{})),e.set(`#issue`,I(ge,{})),e.set(`#setting`,I(_e,{})),e.set(`#search`,I(ve,{})),e.set(`#study`,I(Se,{})),e.set(`#signup`,I(Te,{})),e.set(`#signin`,I(Ee,{})),e.set(`#book`,I(Oe,{}));let t=async()=>{(q.value=await i()??``)?(z(`#home`),await o(),await K(),(async()=>{await r(),J.value=await a()??[],await d(),await f(),await K()})()):z(`#about`)};return k(()=>{t()},[]),e.get(ie.value)};A(I(ke,{}),document.getElementById(`root`));