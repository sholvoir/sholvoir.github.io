import{A as e,C as t,K as n,S as r,V as i,W as a,X as o,Z as s,_ as c,ab as l,ad as u,ae as d,af as f,ag as p,b as m,c as h,d as g,e as _,f as v,g as y,i as b,o as x}from"./tab-DoI6O4al.js";var S=({card:e,class:t})=>{let n=l(e.phonetic),r=l(JSON.stringify(e.meanings,void 0,4)),i=l(e.sound),a=l(!1),o=d(null),s=()=>{i.value?o.current?.play():x(`no sound to play!`)},c=t=>{try{e.meanings=JSON.parse(r.value=t.currentTarget.value),a.value=!1}catch{a.value=!0}};return b(`div`,{class:`flex flex-col h-full gap-2 ${t??``}`,children:[b(`input`,{name:`phonetic`,placeholder:`phonetic`,value:n,onInput:t=>e.phonetic=n.value=t.currentTarget.value}),b(`textarea`,{name:`meanings`,placeholder:`meanings`,class:`h-32 grow ${a.value?`text-red`:``}`,value:r,onInput:c}),b(`div`,{class:`shrink flex`,children:[b(`textarea`,{name:`sound`,rows:1,placeholder:`sound`,class:`grow`,value:i,onInput:t=>e.sound=i.value=t.currentTarget.value}),b(y,{class:`button ml-2`,onClick:s,disabled:!i.value,children:b(`span`,{class:`text-[150%] i-material-symbols-chevron-right`})})]}),b(`audio`,{ref:o,src:i})]})};function C(){let d=l(!1),f=l([]),x=l(``),C=()=>x.value=``,w=(e,t=!0)=>(x.value=e,t&&setTimeout(C,3e3)),T=l(``),E=async()=>{let t=await e(T.value);w(t?`上传成功`:`上传失败`)},D=l(``),O=l(`_`),k=l(0),A=l([]),j=l(``),M=async()=>{let e=encodeURIComponent(D.value);window.open(`https://www.oxfordlearnersdictionaries.com/us/search/english/?q=${e}`,`oxfordlearnersdictionaries`),window.open(`https://www.merriam-webster.com/dictionary/${e}`,`merriam-webster`);let n=await t(D.value);if(!n)return w(`Not Found`);O.value=n.word,k.value=0,A.value=n?.cards??[],j.value=n.word},N=async()=>{let e=await o(j.value);e&&(A.value=[...A.value,e])},P=()=>{A.value.length>1&&(A.value=A.value.toSpliced(k.value,1))},F=async()=>{let e={word:D.value,cards:A.value};w(await n(e)?`success update word "${D.value}"!`:`Error`)},I=async()=>{w(await s(D.value)?`success delete word "${D.value}"!`:`Error`)},L=l(0),R=l([]),z=async()=>{let e=await a();e&&(R.value=e,B())},B=()=>{let e=R.value[L.value];e&&(D.value=e.issue,M())},V=async()=>{let e=R.value[L.value],t=await c(e._id);t.acknowledged&&t.deletedCount>0?(R.value=[...R.value.slice(0,L.value),...R.value.slice(L.value+1)],L.value>=R.value.length&&(L.value=R.value.length-1),R.value.length?B():(D.value=``,O.value=`_`,A.value=[],k.value=0,z()),w(`处理成功!`)):w(`处理失败`)},H=async()=>{(d.value=await r()===`hua`)&&(f.value=await i()??[],await z())};return u(()=>{H()},[]),d.value&&b(p,{children:[b(`div`,{class:`text-center bg-[var(--bg-title)] p-1`,children:x.value||`系统管理-${_} ˈʒɑɜæəɪʌʊʃˌ`}),b(`div`,{class:`body grow flex flex-col gap-2 p-2`,children:[b(`div`,{class:`h-4 grow-4 flex flex-col gap-2`,children:[b(`div`,{class:`flex gap-2`,children:[b(h,{name:`word`,placeholder:`word`,class:`grow`,binding:D,options:f.value,onChange:M}),b(y,{class:`button btn-normal`,disabled:!D.value,onClick:M,children:`Search`})]}),b(`div`,{class:`flex flex-col grow`,children:b(m,{class:`bg-[var(--bg-tab)]`,cindex:k,children:A.value.map(e=>b(S,{card:e},e))})}),b(`div`,{class:`flex justify-between gap-2`,children:[b(v,{class:`grow`,binding:j}),b(y,{class:`grow button btn-normal`,disabled:D.value!=O.value,onClick:N,children:`增卡`}),b(y,{class:`grow button btn-normal`,disabled:D.value!=O.value||A.value.length<=1,onClick:P,children:`删卡`}),b(y,{class:`grow button btn-normal`,disabled:D.value!=O.value,onClick:I,children:`删除`}),b(y,{class:`grow button btn-normal`,disabled:D.value!=O.value,onClick:F,children:`更新`})]})]}),b(`div`,{class:`h-1 grow flex gap-2`,children:[b(`div`,{class:`w-1 grow flex flex-col gap-2`,children:[b(`textarea`,{class:`grow`,value:T,onChange:e=>T.value=e.currentTarget.value}),b(`div`,{class:`flex justify-end`,children:b(y,{class:`w-24 button btn-normal`,onClick:E,children:`拼写忽略`})})]}),b(`div`,{class:`w-1 grow flex flex-col gap-2`,children:[b(`div`,{class:`grow border`,children:b(g,{class:`px-2`,cindex:L,activeClass:`bg-[var(--bg-title)]`,options:R.value.map(e=>`${e.reporter}: ${e.issue}`),onClick:B})}),b(`div`,{class:`flex justify-end gap-2`,children:[b(y,{class:`w-24 button btn-normal`,onClick:z,children:`加载问题`}),b(y,{class:`w-24 button btn-normal`,onClick:V,children:`处理问题`})]})]})]})]})]})}f(b(C,{}),document.getElementById(`root`));