import{A as e,BLevelName as t,E as n,STATUS_CODE as r,addTasks as i,aggrToBAggr as a,button_base_default as o,button_ripple_default as s,citem as c,compareWL as l,deleteItem as u,deleteWordList as d,getClientWordlist as f,getEpisode as ee,getPredict as p,getServerWordlist as m,getUpdatedItem as te,getUser as h,getVocabulary as g,getWordlists as _,go as v,initSetting as y,input_text_default as b,isPhaseAnswer as x,itemUpdateDict as ne,k as S,list_default as C,loca as w,name as T,now as E,otp as D,postMyWordList as O,search as k,setMeta as A,setting as re,settingFormat as ie,showLoading as j,showMainMenu as M,showMenuButton as N,showTips as P,signin as ae,signout as oe,signup as se,splitID as F,sprint as I,startStudy as L,stats as ce,studied as le,submitIssue as R,syncSetting as z,syncTasks as B,tab_default as ue,tips as de,totalStats as V,u as H,useSignal as U,useSignalEffect as fe,user as W,vocabulary as G,wl as K,wlid as pe,y as q}from"./tab-CCl5z6XC.js";const J=e=>new Promise(t=>setTimeout(t,e));var me=({class:e})=>{let t=e=>{e.stopPropagation(),M.value=!1,v(e.currentTarget.title)},n=()=>{W.value=``,v(`#about`),oe()};return H(`div`,{class:`menu p-2 flex flex-col gap-1 ${e??``}`,children:[H(`menu`,{title:`#search`,onClick:()=>{L(),M.value=!1},children:`学习`}),H(`div`,{}),H(`menu`,{title:`#search`,onClick:t,children:`辞典`}),H(`div`,{}),H(`menu`,{title:`#issue`,onClick:t,children:`报告问题`}),H(`div`,{}),H(`menu`,{title:`#wordlists`,onClick:t,children:`我的词书`}),H(`div`,{}),H(`menu`,{title:`#setting`,onClick:t,children:`设置`}),H(`div`,{}),H(`menu`,{title:`#about`,onClick:t,children:`关于`}),H(`div`,{}),H(`menu`,{title:`#help`,onClick:t,children:`帮助`}),H(`div`,{}),H(`menu`,{onClick:n,children:`登出`})]})},he=e=>H(`svg`,{xmlns:`http://www.w3.org/2000/svg`,viewBox:`0 0 128 128`,...e,children:H(`g`,{children:[H(`circle`,{cx:`16`,cy:`64`,r:`16`,fill:`#000000`}),H(`circle`,{cx:`16`,cy:`64`,r:`16`,fill:`#555555`,transform:`rotate(45,64,64)`}),H(`circle`,{cx:`16`,cy:`64`,r:`16`,fill:`#949494`,transform:`rotate(90,64,64)`}),H(`circle`,{cx:`16`,cy:`64`,r:`16`,fill:`#cccccc`,transform:`rotate(135,64,64)`}),H(`circle`,{cx:`16`,cy:`64`,r:`16`,fill:`#e1e1e1`,transform:`rotate(180,64,64)`}),H(`circle`,{cx:`16`,cy:`64`,r:`16`,fill:`#e1e1e1`,transform:`rotate(225,64,64)`}),H(`circle`,{cx:`16`,cy:`64`,r:`16`,fill:`#e1e1e1`,transform:`rotate(270,64,64)`}),H(`circle`,{cx:`16`,cy:`64`,r:`16`,fill:`#e1e1e1`,transform:`rotate(315,64,64)`}),H(`animateTransform`,{attributeName:`transform`,type:`rotate`,values:`45 64 64;90 64 64;135 64 64;180 64 64;225 64 64;270 64 64;315 64 64;0 64 64;`,calcMode:`discrete`,dur:`720ms`,repeatCount:`indefinite`})]})}),Y=({title:e,children:t,leftElem:n,rightElem:r,class:i,onBackClick:a,...s})=>{let c=()=>M.value=!M.value,l=()=>M.value=!1;return H(S,{children:[H(`div`,{class:`title shrink-0 px-2 flex justify-between items-center font-bold`,children:[H(`div`,{class:`w-7 [app-region:no-drag]`,children:n??(a&&H(o,{onClick:a,class:`w-full h-7 i-material-symbols-chevron-left`}))}),H(`div`,{class:`grow font-bold text-center [app-region:drag]`,children:de.value||e}),H(`div`,{class:`w-7 [app-region:no-drag]`,children:r??(W.value&&N.value&&H(o,{onClick:c,class:`w-full h-7 i-heroicons-outline-dots-horizontal`}))})]}),H(`div`,{class:`body relative grow h-0 ${i??``}`,...s,children:[t,M.value&&H(`div`,{class:`absolute inset-0 bg-[var(--bg-menu)] flex justify-end`,children:[H(`div`,{class:`grow`,onClick:l}),H(me,{class:`grow bg-[var(--bg-body)]`})]}),j.value&&H(`div`,{class:`absolute inset-0 bg-[var(--bg-half)] flex justify-center content-center flex-wrap`,children:H(he,{class:`w-16 h-16`})})]})]})};const X=(e,t)=>e+t,ge=(e,t)=>e>t?e:t;var _e=({stat:e})=>{let n=a(e.total),r=a(e.task),i=n.reduce(ge)*1.2,o=e.total.reduce(X),s=e.task.reduce(X),c=e.wlid?F(e.wlid)[1]:``,l=`${e.disc??c} - ${s}|${o}`,u=e=>{let a=n[e],o=r[e];return H(S,{children:[H(`div`,{class:`text-left`,children:t[e]}),H(`div`,{class:`relative bg-[var(--bg-title)] h-6 py-1 w-full hover:cursor-pointer`,children:[H(`div`,{class:`my-auto h-4 bg-slate-400`,style:{width:`${i?a*100/i:100}%`},children:H(`div`,{class:`ml-auto h-full bg-orange-500`,style:{width:`${a?o*100/a:0}%`}})}),H(`div`,{class:`absolute top-0 right-1`,children:[o,`|`,a]})]})]})};return H(`div`,{class:`grow min-w-80 grid gap-x-1 grid-cols-[max-content_1fr] items-center`,children:[H(`div`,{class:`col-span-2 text-center font-bold`,children:H(`button`,{type:`button`,class:`hover:cursor-pointer hover:underline`,onClick:()=>L(e.wlid),children:l})}),[0,1,2,3,4,5].map(u)]})},ve=()=>H(Y,{title:`学习进度`,class:`body overflow-y-auto p-2 flex flex-wrap justify-between content-start gap-4`,children:ce.value.stats.map(e=>H(_e,{stat:e},`${e.time}${e.wlid}`))}),ye=()=>H(Y,{class:`flex flex-col pb-4`,title:`帮助`,onBackClick:()=>v(),children:H(`ol`,{class:`list-decimal py-2 pr-2 pl-8 [&>li]:mx-2 overflow-y-auto`,children:[H(`li`,{children:[`如何使用本软件？`,H(`br`,{}),`答：点击「学习」，开始学习即可；在学习界面， (1)当练习听力时，会先播放一小段声音，没有听清可以点击`,H(`div`,{class:`w-6 h-6 inline-block`,children:`‣`}),`或按下「B或C」快捷键或触摸屏幕的上半部分进行重听， (2)当练习阅读时，会先显示一个单词； 然后在心里默想一个概念（意思），点击「答」或按下「空格键」或触摸屏幕下半区域，显示单词的音标和解释， 并同时显示一个与该词相关的背景图片，检查是否和自己默想的答案一致，如果一致，点击「知」或按下「N或X」快捷键或向上滑动屏幕， 否则点击「不」或按下「M或Z」快捷键或向下滑动屏幕。记住，要快速完成，不要在一个词上长时间停留，那样只会降低效率， 我们的方法是快速/多次，从记忆效率来讲，次数的作用远远大于时长。这个方法称为大脑按摩，直接在拼写/声音和概念之间建立反射弧， 所以不要犹豫，快速完成一个小冲刺。`]}),H(`li`,{children:[`我应该学习哪些词汇？`,H(`br`,{}),`答：我们的目标是在未来能够自由使用英语，应该先学重要的词汇，因为20%的英语词汇表达了80%的意思， 抓住少数基本词，将能够快速提高英语水平。本软件提供多本词书供您选择，以适应您当下的需求。但不要太多关注词书， 一个常用词通常会出现在多本词书中，不必介意它到底从哪里来。也可以不选择词书，直接基于词典 （本词典收录25000多条常用词，不在词典中的词，对于学生而言，可以不必记忆了），在词典中查到自己在生活中遇到， 但不会的词，直接开始学它，背它，终有一日，你再也遇不到生词的时候，你就已经功法大成了。`]}),H(`li`,{children:[`我该如何复习？`,H(`br`,{}),`答：完全不必操心这个事情，让系统决定，系统自动根据「艾宾浩斯」遗忘曲线来决定此时的最佳复习内容， 你要做的事是每天利用碎片时间，拿出手机，开始「学习」。`]}),H(`li`,{children:[`界面上的按钮是什么意思？`,H(`br`,{}),H(`span`,{class:`text-[150%] i-material-symbols-check-circle text-green`}),`我认识这个词；`,H(`br`,{}),H(`span`,{class:`text-[150%] i-gridicons-cross-circle text-fuchsia`}),`我不认识这个词；`,H(`br`,{}),H(`span`,{class:`text-[150%] i-material-symbols-volume-up text-blue`}),`: 再播一遍声音；`,H(`br`,{}),H(`span`,{class:`text-[150%] i-material-symbols-light-family-star text-yellow`}),`: 这个词我已经掌握，直接标记为「已完成」；`,H(`br`,{}),H(`span`,{class:`text-[150%] i-material-symbols-error text-red`}),`: 这个词的翻译/声音/音标，有问题/错误，请人工处理。`,H(`br`,{}),H(`span`,{class:`text-[150%] i-material-symbols-refresh text-purple`}),`: 忽略本地词典缓冲，从服务器重新下载这个词的翻译/声音/音标。`]}),H(`li`,{children:[`关于「学习词书」`,H(`br`,{}),`答：学习词书将一本词书的全部词添加进我的学习任务。但我们通常并不会直接开始学这些新词，而是优先复习旧词， 掌握巩固一个旧词比学习一批新词更重要，这些新加的任务将会成为优先级最低的任务。`]}),H(`li`,{children:[`关于登录和多设备`,H(`br`,{}),`答：⓵软件设计为免密模式（不需要密码），在一个设备上只要用电子邮件验证身份之后，就再也不需要密码了，打开软件立即可以开始学习。`,H(`br`,{}),`⓶在第二台设备上登录时，系统将自动同步学习记录和设置，你完全可以同时在电脑和手机上学习。`]}),H(`li`,{children:[`以后有AI翻译了，我还用得着学英语吗？`,H(`br`,{}),`答：AI或者任意翻译工具甚至包括人工翻译，都只能解决浅表问题，因为一门语言是无法准确表达另一门语言的含义的， 一门语言的背后代表着文化和思维模式，这些深层次的东西是任何翻译都无法解决的。如果你有计划去英语文华圈生活/学习/工作， 那你必需亲自用人脑学好它，仅仅翻译工具是不够的。`]})]})}),Z=({binding:e,...t})=>H(`input`,{...t,value:e.value?.toString(),onInput:t=>e.value=t.currentTarget.value});const be=`0.12.1`;var xe=()=>{let e=U(!1),t=U(``);return N.value=!1,H(Y,{title:`快乐背单词`,class:`about flex flex-col pb-4 font-extrabold`,onBackClick:W.value?()=>{v(`#home`),N.value=!0}:void 0,children:[e.value&&H(S,{children:[H(Z,{binding:t}),H(o,{class:`button btn-normal`,onClick:()=>A(`_auth`,t.value),children:`OK`})]}),H(`div`,{children:[H(`h1`,{children:`快乐背单词`}),H(`p`,{children:[`版本：`,be]})]}),H(`div`,{children:[H(`h1`,{children:`语言基础`}),H(`p`,{children:[`词汇是`,H(`b`,{children:`语言的基础`}),`，学习语言应该掌握一定数量的基础词汇。`]})]}),H(`div`,{children:[H(`h1`,{children:`高频词汇`}),H(`p`,{children:[`每个词汇的重要程度是不一样的，越是使用`,H(`b`,{children:`频率高的词汇`}),`，其重要程度越高，本工具提供多种词频工具统计的结果词书。`]})]}),H(`div`,{children:[H(`h1`,{children:`遗忘曲线`}),H(`p`,{children:[`记忆最大的敌人是遗忘，本工具依据「艾宾浩斯」`,H(`b`,{children:`遗忘曲线`}),`设计大脑刺激频率，以最大化记忆效率。`]})]}),H(`div`,{children:[H(`h1`,{children:`碎片时间`}),H(`p`,{children:[`现代人工作学习都非常忙碌，充分利用好`,H(`b`,{children:`碎片时间`}),`，是成功的关键。`]})]}),H(`div`,{children:[H(`h1`,{children:`开始学习`}),H(`p`,{children:[`使用你的手机，单击`,H(s,{class:`button bg-orange-300 text-slate-800`,title:`login`,onClick:()=>v(`#signup`),children:`登录`}),`开始免费学习吧。`]})]}),H(`div`,{children:[H(`h1`,{children:`微信`}),H(`p`,{children:[`*提示一：请使用`,H(`b`,{children:`除微信以外`}),`的其他浏览器，如果当前是在微信中，点击屏幕右上(...)，然后选择「在默认浏览器中打开」。`]})]}),H(`div`,{children:[H(`h1`,{children:`桌面`}),H(`p`,{children:[`*提示二(iOS): 请使用「共享」-「添加到主屏幕」安装 `,H(`b`,{children:`Web应用`}),` 到桌面，以便下次直接`,H(o,{onClick:()=>e.value=!0,children:`点击`}),`进入。`]}),H(`p`,{children:[`*提示三(Android): 请使用「...」-「安装应用」安装 `,H(`b`,{children:`Web应用`}),` 到桌面，以便下次直接点击进入。`]})]})]})},Se=({binding:e,...t})=>H(`textarea`,{...t,value:e.value,onInput:t=>e.value=t.currentTarget.value}),Ce=()=>{let e=U(``),t=async()=>{await R(e.value),P(`提交成功!`),v()};return H(Y,{class:`p-2 flex flex-col`,title:`提交问题`,children:[H(`label`,{children:`请在这里描述你的问题:`}),H(Se,{name:`issue`,class:`grow`,binding:e,children:e.value}),H(`div`,{class:`flex gap-2 mt-2 pb-3 justify-end`,children:[H(s,{class:`w-24 button btn-normal`,onClick:()=>v(),children:`取消`}),H(s,{class:`w-24 button btn-prime`,onClick:t,children:`提交`})]})]})},we=()=>{let e=U(`^common`),t=U(0),n=U([]),r=U(0),a=U([]),o=()=>{a.value=[...a.value,n.value[r.value]]},c=()=>{a.value=[...a.value.slice(0,t.value),...a.value.slice(t.value+1)]},u=async()=>{j.value=!0,await i(a.value[t.value].wlid),await V(),j.value=!1},d=async()=>{await z({format:ie,version:E(),books:a.value.map(e=>e.wlid)}),await V(),v()},f=async()=>{n.value=(await m()).filter(e=>e.wlid.startsWith(`common`)).sort(l),a.value=await _(e=>re.books.includes(e.wlid))};return fe(()=>{(async()=>{let t=new RegExp(e.value);n.value=(await _(e=>t.test(e.wlid)||e.disc&&t.test(e.disc))).sort(l)})()}),q(()=>{f()},[]),H(Y,{class:`p-2 gap-2 flex flex-col`,title:`设置`,children:[H(`div`,{class:`flex gap-2`,children:[H(`label`,{for:`filter`,children:`设置过滤`}),H(Z,{class:`grow`,name:`filter`,binding:e})]}),H(`fieldset`,{class:`border rounded max-h-[50%] grow overflow-y-auto px-2`,children:[H(`legend`,{children:`可用的词书`}),H(C,{class:`px-2`,cindex:r,options:n.value.map(e=>e.disc??e.wlid),activeClass:`bg-[var(--bg-title)]`})]}),H(`div`,{class:`flex justify-between gap-2`,children:[H(s,{class:`button btn-normal grow`,onClick:o,children:`添加订阅`}),H(s,{class:`button btn-normal grow`,onClick:c,children:`删除订阅`})]}),H(`fieldset`,{class:`border rounded max-h-[50%] grow overflow-y-auto px-2`,children:[H(`legend`,{children:`我订阅的词书`}),H(C,{class:`px-2`,cindex:t,options:a.value.map(e=>e.disc??e.wlid),activeClass:`bg-[var(--bg-title)]`})]}),H(`div`,{class:`pb-3 flex justify-between gap-2`,children:[H(s,{class:`button btn-normal grow`,onClick:u,children:`添加任务`}),H(s,{class:`button btn-normal grow`,onClick:()=>v(),children:`取消`}),H(s,{class:`button btn-prime grow`,onClick:d,children:`保存`})]})]})},Te=()=>{let e=U(``),t=async()=>{let t=e.peek().trim();if(!t)return;let n=await k(t);if(!n)return P(`Not Found!`);c.value=n,x.value=!0,I.value=-1,v(`#study`)};return H(Y,{class:`flex flex-col text-lg`,title:`词典`,onBackClick:()=>v(),children:H(b,{autoCapitalize:`none`,type:`search`,name:`word`,placeholder:`word`,class:`m-2 w-[calc(100%-16px)]`,binding:e,onChange:t,options:G.value})})},Q=({card:e})=>e&&H(S,{children:[e.trans?.split(`
`).map((e,t)=>H(`p`,{class:`text-2xl`,children:e},t)),e.def?.split(`
`).map((e,t)=>e.startsWith(` `)?H(`p`,{class:`text-lg`,children:[` •`,e]},t):H(`p`,{class:`text-xl font-bold`,children:e},t))]}),Ee=()=>{let t=async()=>{v(),await V(),await B(),V()};if(!c.value)return v(),H(`div`,{});let n=U(0),i=U(0),a=U(0),s=U([]),l=U(!1),d=e(null),p=e=>le(c.value.word,e),m=async()=>{if(++I.value<=0)return t();let e=await ee(pe.value);if(!e)return t();c.value=e,x.value=!1,n.value=0},h=async(e,t)=>{a.value+=e;let n=Math.abs(a.value-i.value);n<t&&(await J(30),await h(e,t))},g=async()=>{P(`Get Server Data...`);let e=await te(c.value.word);if(!e)return P(`Not Found ${c.value.word}`);c.value=e},y=async()=>{P(`Submiting...`,!1),await R(c.value.word),P(`Submit Success!`)},b=async()=>{P(await u(c.value.word)?`删除成功`:`删除失败`)},ne=e=>{if(e.stopPropagation(),!(e.ctrlKey||e.altKey))switch(e.key){case` `:D(e);break;case`N`:case`X`:case`n`:case`x`:x.value&&p().then(m);break;case`M`:case`Z`:case`m`:case`z`:x.value&&p(0).then(m);break}},C=e=>{e.stopPropagation(),e.preventDefault(),x.value&&(a.value=i.value=e.touches[0].clientY)},w=e=>{e.stopPropagation(),e.preventDefault(),x.value&&(a.value=e.touches[0].clientY)},T=e=>{e.stopPropagation(),e.preventDefault(),x.value&&(a.value=i.value=0)},E=async e=>{if(e.stopPropagation(),e.preventDefault(),x.value){let t=e.currentTarget.scrollHeight+60,n=a.value-i.value,r=Math.max(globalThis.innerHeight,t);Math.abs(n)>=globalThis.innerHeight/6?(n>0?(await p(0),await h(60,r)):(await p(),await h(-60,r)),await m()):Math.abs(n)<5&&D()}else D();a.value=i.value=0},D=e=>{if(e?.stopPropagation(),l.value)return l.value=!1;let t=c.value.cards.length??0;t!==0&&(x.value?t===1?d.current?.play():n.value<t-1?n.value++:n.value=0:(x.value=!0)&&d.current?.play())},k=async e=>{l.value=!1;let t=c.value.word,n=(await f(e.wlid))?.wordSet;if(n?.has(t))return P(`已包含`);let[i,a]=F(e.wlid),[o]=await O(a,t);P(o==r.OK?`添加成功`:`添加失败`),n?.add(c.value.word)},A=async()=>{s.value=await _(e=>e.wlid.startsWith(W.value))};return q(()=>{A()},[]),H(Y,{onBackClick:t,class:`flex flex-col p-2`,title:`学习${I.value>0?`(${I.value})`:``}`,children:[H(`div`,{class:`relative flex gap-4 text-[150%] justify-between items-end`,children:[H(o,{disabled:!x.value,title:`X/N`,onClick:()=>p().then(m),class:`i-material-symbols-check-circle text-green`}),H(o,{disabled:!x.value,title:`Z/M`,onClick:()=>p(0).then(m),class:`i-gridicons-cross-circle text-fuchsia`}),H(o,{disabled:!x.value,onClick:()=>p(13).then(m),class:`i-material-symbols-light-family-star text-yellow`}),H(o,{disabled:!x.value,onClick:b,class:`i-material-symbols-delete-outline text-orange`}),H(o,{onClick:()=>d.current?.play(),class:`i-material-symbols-volume-up text-blue`}),H(o,{disabled:!x.value,onClick:y,class:`i-material-symbols-error text-red`}),H(o,{disabled:!x.value,onClick:g,class:`i-material-symbols-refresh text-purple`}),H(o,{disabled:!x.value,onClick:()=>l.value=!l.value,class:`i-material-symbols-dictionary-outline text-cyan`}),H(`div`,{class:`text-lg`,children:c.value.level}),l.value&&H(`div`,{class:`menu absolute top-[100%] right-[36px] text-lg text-right bg-[var(--bg-body)] z-1`,children:[s.value.map(e=>H(S,{children:[H(`div`,{}),H(`menu`,{onClick:()=>k(e),children:e.disc??e.wlid})]},e)),s.value.length&&H(`div`,{})]})]}),H(`div`,{class:`relative grow h-0 pb-4 flex flex-col outline-none`,tabIndex:-1,style:{top:`${a.value-i.value}px`},onTouchStart:C,onTouchMove:w,onTouchEnd:E,onTouchCancel:T,onClick:D,onKeyUp:ne,children:[H(`div`,{class:`py-2 flex gap-2 flex-wrap justify-between`,children:[H(`div`,{class:`text-4xl font-bold`,children:c.value.word}),x.value&&H(`div`,{class:`text-2xl flex items-center`,children:c.value.cards?.[n.value].phonetic})]}),x.value&&((c.value.cards.length??0)>1?H(ue,{class:`bg-[var(--bg-tab)]`,cindex:n,children:c.value.cards.map((e,t)=>H(Q,{card:e},`${c.value.word}${t}`))}):H(`div`,{class:`grow h-0 overflow-y-auto`,children:H(Q,{card:c.value.cards?.[0]})})),H(`audio`,{ref:d,autoPlay:!0,src:c.value.cards.at(n.value)?.sound??``})]})]})};const De=/^[_\w-]+$/,Oe=/^\+\d+$/;var ke=()=>{let e=U(``),t=()=>{v(`#signin`)},n=async()=>{if(!De.test(T.value))return P(`Name can only include _, letter, number and -`);let t=e.value.replaceAll(/[\(\) -]/g,``);if(!Oe.test(t))return P(`Invalid phone number!`);switch(await se(t,T.value)){case r.BadRequest:return P(`用户名已注册`);case r.Conflict:return P(`电话号码已注册`);case r.OK:P(`注册成功，请登录`),v(`#signin`)}};return H(Y,{class:`p-2 flex flex-col`,title:`注册`,onBackClick:()=>v(),children:H(`div`,{class:`w-64 m-auto flex flex-col pb-4`,children:[H(`label`,{children:`用户名`}),H(Z,{name:`name`,placeholder:`name`,autoCapitalize:`none`,binding:T,class:`mb-3`}),H(`label`,{children:`手机号码(含国际区号)`}),H(Z,{name:`phone`,placeholder:`+1(987)765-5432`,autoCapitalize:`none`,binding:e,class:`mb-3`}),H(`div`,{class:`text-right mb-3`,children:[`已经注册，请`,H(s,{class:`button btn-normal mx-1`,onClick:t,children:`登录`})]}),H(s,{class:`button btn-prime py-1`,onClick:n,children:`注册`})]})})};let $;var Ae=()=>{let e=U(``),t=U(0),n=U(!0),i=async()=>{switch(n.value=!1,t.value=60,$=setInterval(()=>{--t.value<=0&&(clearInterval($),$=void 0,n.value=!0)},1e3),await D(T.value)){case r.BadRequest:return P(`请输入用户名`);case r.NotFound:return P(`未找到用户`);case r.FailedDependency:return P(`此用户未注册手机号码`);case r.TooEarly:return P(`请求OTP过于频繁`);case r.OK:return P(`OTP已发送`);default:return P(`未知服务器错误`)}},a=async()=>{switch(await ae(T.value,e.value)){case r.BadRequest:return P(`请输入用户名和密码`);case r.NotFound:return P(`未找到用户`);case r.Unauthorized:return P(`错误的密码`);case r.OK:P(`已登录`),$&&clearInterval($),location.reload()}};return H(Y,{class:`p-2 flex flex-col`,title:`登录`,onBackClick:()=>v(),children:H(`div`,{class:`w-64 m-auto flex flex-col`,children:[H(`label`,{for:`name`,children:`用户名`}),H(Z,{name:`name`,class:`mb-3`,placeholder:`name`,autoCapitalize:`none`,binding:T}),H(`label`,{for:`code`,children:`临时密码`}),H(Z,{name:`code`,placeholder:`code`,autoCapitalize:`none`,binding:e}),H(o,{class:`btn-anchor block text-right mb-3`,onClick:i,disabled:!n.value,children:[`Send One-Time Passcode `,t.value>0?`(${t.value})`:``]}),H(s,{class:`button btn-prime`,onClick:a,children:`登录`})]})})},je=()=>{let e=U(0),t=U([]),n=()=>{K.value=void 0,v(`#wordlist`)},r=async()=>{P(await d(t.value[e.value].wlid)?`删除成功`:`删除失败`),t.value=[...t.value.slice(0,e.value),...t.value.slice(e.value+1)]},i=()=>{K.value=t.value[e.value],v(`#wordlist`)},a=async()=>{t.value=(await m()).filter(e=>e.wlid.startsWith(W.value)).sort(l)};return q(()=>{a()},[]),H(Y,{class:`p-2 flex flex-col gap-2`,title:`我的词书`,children:[H(`div`,{class:`h-0 grow border overflow-y-auto`,children:H(C,{cindex:e,options:t.value.map(e=>e.disc??e.wlid),class:`px-2`,activeClass:`bg-[var(--bg-title)]`})}),H(`div`,{class:`pb-3 flex justify-end gap-2`,children:[H(s,{class:`w-24 button btn-normal`,name:`cancel`,onClick:()=>v(),children:`取消`}),H(s,{class:`w-24 button btn-normal`,name:`new`,onClick:n,children:`新建`}),H(s,{class:`w-24 button btn-normal`,name:`delete`,disabled:!t.value.length,onClick:r,children:`删除`}),H(s,{class:`w-24 button btn-normal`,name:`update`,disabled:!t.value.length,onClick:i,children:`更新`})]})]})},Me=({label:e,binding:t,disabled:n,class:r,onChange:i,...a})=>{let o=e=>{e.stopPropagation(),n||(t.value=!t.value,i&&i(e))};return H(`div`,{class:`${n?`opacity-50`:``} ${r??``}`,"aria-disabled":n,onClick:o,...a,children:[H(`span`,{class:`text-[150%] ${t.value?`i-material-symbols-check-box-outline`:`i-material-symbols-check-box-outline-blank`}`}),e]})},Ne=()=>{let e=U(``),t=U(``),n=U(``),i=U(!1),a=U(``),o=async()=>{let t=`${W.value}/${e}`,r=await f(t);r&&(n.value=Array.from(r.wordSet).sort().join(`
`))},c=async()=>{e.value=e.value.replaceAll(`/`,`-`);let[o,s]=await O(e.value,n.value,t.value,i.value?`1`:void 0);switch(o){case r.BadRequest:return P(`Error: 无名称或无内容`);case r.NotAcceptable:return a.value=Object.entries(s).map(([e,t])=>`${e}: ${t.join(`,`)}`).join(`
`),P(`未通过拼写检查`);case r.OK:P(`词书上传成功`),v()}};return q(()=>{K.value&&(e.value=F(K.value.wlid)[1],K.value.disc&&(t.value=K.value.disc))},[]),H(Y,{class:`flex flex-col p-2`,title:`上传我的词书`,onBackClick:()=>v(),children:[H(`label`,{for:`name`,children:`名称`}),H(Z,{name:`name`,binding:e}),H(`label`,{for:`disc`,class:`mt-2`,children:`描述`}),H(Z,{name:`disc`,binding:t}),H(`label`,{for:`words`,class:`mt-2`,children:`词表`}),H(Se,{name:`words`,class:`grow`,binding:n}),a.value.length?H(S,{children:[H(`label`,{for:`replace`,class:`text-red-500 mt-2`,children:`请考虑用下面的词替换`}),H(`textarea`,{name:`replace`,class:`grow`,value:a,onChange:e=>a.value=e.currentTarget.value})]}):void 0,H(`div`,{class:`flex gap-2 my-2`,children:[H(Me,{binding:i,label:`Replace`}),H(`div`,{class:`grow`}),H(s,{class:`w-24 button btn-normal`,onClick:o,children:`下载`}),H(s,{class:`w-24 button btn-prime`,onClick:c,children:`上传`})]})]})},Pe=()=>{let e=new Map;e.set(`#home`,H(ve,{})),e.set(`#help`,H(ye,{})),e.set(`#about`,H(xe,{})),e.set(`#issue`,H(Ce,{})),e.set(`#setting`,H(we,{})),e.set(`#search`,H(Te,{})),e.set(`#study`,H(Ee,{})),e.set(`#signup`,H(ke,{})),e.set(`#signin`,H(Ae,{})),e.set(`#wordlists`,H(je,{})),e.set(`#wordlist`,H(Ne,{}));let t=async()=>{if(W.value=await h()??``){v(`#home`),N.value=!0,await y(),await V();let e=await g();e&&(G.value=e),(async()=>{m(),await z(),await B(),await V();for(let e of await p(3600,500))await ne(e),await J(300)})()}else v(`#about`)};return q(()=>{t()},[]),e.get(w.value)};n(H(Pe,{}),document.getElementById(`root`));